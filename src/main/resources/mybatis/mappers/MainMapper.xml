<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.team01.index.dao.MainDao">

<!--  문자열 가공은 Java에서,분기·정렬·제한은 DB에서-->
    <select id="selectBooks" resultType="BookVO">
        SELECT
            t.rank,
            t.bookId,
            t.bookCateNm,
            t.bookCateDepth,
            t.bookName,
            t.bookDesc,
            t.author,
            t.roleId,
            t.cateId,
            t.writer,
            t.bookImgPath,
            t.saleStatus,
            t.delStatus,
            t.recomType
        FROM (
            SELECT
                ROW_NUMBER() OVER (
                    PARTITION BY b.cateId
                    ORDER BY b.bookId DESC
                ) AS rank,
            b.*
            FROM book b
        WHERE b.delStatus = 'N'
        ) t
<!--  <![CDATA[ WHERE t.rank <= 8]]>-->
    </select>



</mapper>